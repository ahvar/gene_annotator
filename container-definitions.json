[
  {
    "name": "mysql",
    "image": "001570960384.dkr.ecr.us-east-1.amazonaws.com/mysql:9.3.0",
    "cpu": 0,
    "portMappings": [
      {
        "containerPort": 3306,
        "hostPort": 3306,
        "protocol": "tcp"
      }
    ],
    "essential": true,
    "environment": [
      {
        "name": "MYSQL_RANDOM_ROOT_PASSWORD",
        "value": "yes"
      },
      {
        "name": "MYSQL_DATABASE",
        "value": "gene_annotator"
      },
      {
        "name": "MYSQL_USER",
        "value": "gene-annotator"
      }
    ],
    "secrets": [
      {
        "name": "MYSQL_PASSWORD",
        "valueFrom": "arn:aws:secretsmanager:us-east-1:001570960384:secret:/gene-annotator/DbPassword"
      }
    ],
    "logConfiguration": {
      "logDriver": "awslogs",
      "options": {
        "awslogs-group": "/ecs/gene-annotator",
        "awslogs-region": "us-east-1",
        "awslogs-stream-prefix": "mysql"
      }
    }
  },
  {
    "name": "gene-annotator",
    "image": "001570960384.dkr.ecr.us-east-1.amazonaws.com/gene-annotator:latest",
    "cpu": 0,
    "portMappings": [
      {
        "containerPort": 5000,
        "hostPort": 5000,
        "protocol": "tcp"
      }
    ],
    "essential": true,
    "environment": [
      {
        "name": "MAIL_PORT",
        "value": "587"
      },
      {
        "name": "MAIL_USERNAME",
        "value": "arthurvargasdev@gmail.com"
      },
      {
        "name": "MAIL_USE_TLS",
        "value": "true"
      },
      {
        "name": "ELASTICSEARCH_URL",
        "value": "http://elasticsearch:9200"
      },
      {
        "name": "MAIL_SERVER",
        "value": "smtp.sendgrid.net"
      }
    ],
    "secrets": [
      {
        "name": "SECRET_KEY",
        "valueFrom": "arn:aws:secretsmanager:us-east-1:001570960384:secret:/gene-annotator/FlaskSecretKey"
      },
      {
        "name": "MAIL_PASSWORD",
        "valueFrom": "arn:aws:secretsmanager:us-east-1:001570960384:secret:/gene-annotator/SendGridApiKey"
      },
      {
        "name": "MS_TRANSLATOR_KEY",
        "valueFrom": "arn:aws:secretsmanager:us-east-1:001570960384:secret:/gene-annotator/MsTranslatorKey"
      },
      {
        "name": "MYSQL_PASSWORD",
        "valueFrom": "arn:aws:secretsmanager:us-east-1:001570960384:secret:/gene-annotator/DbPassword"
      }
    ],
    "command": [
        "sh","-c","/opt/pipeline/boot.sh"
    ],
    "logConfiguration": {
      "logDriver": "awslogs",
      "options": {
        "awslogs-group": "/ecs/gene-annotator",
        "awslogs-region": "us-east-1",
        "awslogs-stream-prefix": "app"
      }
    }
  },
  {
    "name": "elasticsearch",
    "image": "001570960384.dkr.ecr.us-east-1.amazonaws.com/elasticsearch:8.11.1",
    "cpu": 0,
    "portMappings": [
      {
        "containerPort": 9200,
        "hostPort": 9200,
        "protocol": "tcp"
      }
    ],
    "essential": false,
    "environment": [
      {
        "name": "discovery.type",
        "value": "single-node"
      },
      {
        "name": "xpack.security.enabled",
        "value": "false"
      }
    ],
    "logConfiguration": {
      "logDriver": "awslogs",
      "options": {
        "awslogs-group": "/ecs/gene-annotator",
        "awslogs-region": "us-east-1",
        "awslogs-stream-prefix": "elasticsearch"
      }
    }
  }
]
